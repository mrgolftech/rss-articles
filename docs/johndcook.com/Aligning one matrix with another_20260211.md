# Aligning one matrix with another

**来源:** [johndcook.com](https://johndcook.com)
**发布时间:** Wed, 11 Feb 2026 13:23:50 +0000
**链接:** https://www.johndcook.com/blog/2026/02/11/orthogonal-procrustes/

---

{'type': 'text/html', 'language': None, 'base': 'https://www.johndcook.com/blog/feed/', 'value': '<p>Suppose you have two\xa0<em>n</em> × <em>n</em> matrices, <em>A</em> and <em>B</em>, and you would like to find a rotation matrix Ω that lines up\xa0<em>B</em> with\xa0<em>A</em>. That is, you&#8217;d like to find Ω such that</p>\n<p style="padding-left: 40px;"><em>A</em> = Ω<em>B</em>.</p>\n<p>This is asking too much, except in the trivial case of\xa0<em>A</em> and\xa0<em>B</em> being 1 × 1 matrices. You could view the matrix equation above as a set of <em>n</em>² equations in real numbers, but the space of orthogonal matrices only has\xa0<em>n</em>(<em>n</em> − 1) degrees of freedom [1].</p>\n<p>When an equation doesn&#8217;t have an exact solution, the next best thing is to get as close as possible to a solution, typically in a least squares sense. The <strong>orthogonal Procrustes problem</strong> is to find an orthogonal matrix Ω minimizing the distance between <em>A</em> and Ω<em>B</em> That is, we want to minimize</p>\n<p style="padding-left: 40px;">||\xa0<em>A</em> − Ω<em>B</em> ||</p>\n<p>subject to the constraint that Ω is orthogonal. The matrix norm used in this problem is the Frobenius norm, the sum of the squares of the matrix entries. The Frobenius norm is the 2-norm if we straighten the matrices into vectors of dimension <em>n</em>².</p>\n<p>Peter Schönemann found a solution to the orthogonal Procrustes problem in 1964. His solution involves singular value decomposition (SVD). This shouldn&#8217;t be surprising since SVD solves the problem of finding the closest thing to an inverse of an non-invertible matrix. (More on that <a href="https://www.johndcook.com/blog/2018/05/05/svd/">here</a>.)</p>\n<p>Schönemann&#8217;s solution is to set\xa0<em>M</em> =\xa0<em>AB</em><sup>T</sup> and find its singular value decomposition</p>\n<p style="padding-left: 40px;"><em>M</em> = <em>U</em>Σ<em>V</em><sup>T</sup>.</p>\n<p>Then</p>\n<p style="padding-left: 40px;">Ω = <em>UV</em><sup>T</sup>.</p>\n<h2>Python code</h2>\n<p>The following code illustrates solving the orthogonal Procrustes problem for random matrices.</p>\n<pre>import numpy as np\n\nn = 3\n\n# Generate random n x n matrices A and B\nrng = np.random.default_rng(seed=20260211) \nA = rng.standard_normal((n, n))\nB = rng.standard_normal((n, n))\n\n# Compute M = A * B^T\nM = A @ B.T\n\n# SVD: M = U * Sigma * V^T\nU, s, Vt = np.linalg.svd(M, full_matrices=False)\n\n# R = U * V^T\nR = U @ Vt\n\n# Verify that R * R^T is very nearly the identity matrix\nprint("||R^T R - I||_F =", np.linalg.norm(R.T @ R - np.eye(n), ord="fro"))\n</pre>\n<p>In this example the Frobenius norm between <em>RR</em><sup>T</sup> and <em>I</em> is 4 × 10<sup>−16</sup>, so essentially <em>RR</em><sup>T</sup> = <em>I</em> to machine precision.</p>\n<h2>Related posts</h2>\n<ul>\n<li class="link"><a href="https://www.johndcook.com/blog/2018/05/06/least-squares/">Least squares solution to over-determined systems</a></li>\n<li class="link"><a href="https://www.johndcook.com/blog/2018/05/05/svd/">Moore-Penrose pseudoinverse</a></li>\n<li class="link"><a href="https://www.johndcook.com/blog/2025/05/21/drazin-pseudoinverse/">Drazin pseudoinverse</a></li>\n</ul>\n<p>[1] Every column of an orthogonal matrix Ω must have length 1, so that gives <em>n</em> constraints. Furthermore, each pair of columns must be orthogonal, which gives <em>n</em> choose 2 more constraints. We start with Ω having <em>n</em>² degrees of freedom, but then remove <em>n</em> and then <em>n</em>(<em>n</em> − 1)/2 degrees of freedom.</p>\n<p style="padding-left: 40px;"><em>n</em>² − <em>n</em> − <em>n</em>(<em>n</em> − 1)/2 = <em>n</em>(<em>n</em> − 1)/2</p>The post <a href="https://www.johndcook.com/blog/2026/02/11/orthogonal-procrustes/">Aligning one matrix with another</a> first appeared on <a href="https://www.johndcook.com/blog">John D. Cook</a>.'}

---

*抓取时间: 2026-02-12 00:02:59*
