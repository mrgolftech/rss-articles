# Expressing a prime as the sum of two squares

**来源:** [johndcook.com](https://johndcook.com)
**发布时间:** Fri, 13 Feb 2026 02:34:58 +0000
**链接:** https://www.johndcook.com/blog/2026/02/12/pythagorean-primes/

---

{'type': 'text/html', 'language': None, 'base': 'https://www.johndcook.com/blog/feed/', 'value': '<p>I saw where Elon Musk <a href="https://x.com/elonmusk/status/2022034584536555592?s=20">posted</a> Grok&#8217;s answer to the prompt &#8220;What are the most beautiful theorems.&#8221; I looked at the list, and there were no surprises, as you&#8217;d expect from a program that works by predicting the most likely sequence of words based on analyzing web pages.</p>\n<p>There&#8217;s only one theorem on the list that hasn&#8217;t appeared on this blog, as far as I can recall, and that&#8217;s Fermat&#8217;s theorem that an odd prime\xa0<em>p</em> can be written as the sum of two squares if and only if\xa0<em>p</em> = 1 mod 4. The &#8220;only if&#8221; direction is easy [1] but the &#8220;if&#8221; direction takes more effort to prove.</p>\n<p>If\xa0<em>p</em> is a prime and\xa0<em>p</em> = 1 mod 4, Fermat&#8217;s theorem guarantees the existence of\xa0<em>x</em> and\xa0<em>y</em> such that</p>\n<p><img alt="x^2 + y^2 = p" class="aligncenter" height="22" src="https://www.johndcook.com/pythagprime.svg" style="background-color: white;" width="90" /></p>\n<h2>Gauss&#8217; formula</h2>\n<p>Stan Wagon [2] gave an algorithm for finding a pair (<em>x</em>,\xa0<em>y</em>) to satisfy the equation above [2]. He also presents &#8220;a beautiful formula due to Gauss&#8221; which &#8220;does not seem to be of any value for computation.&#8221; Gauss&#8217; formula says that if\xa0<em>p</em> = 4<em>k</em> + 1, then a solution is</p>\n<p><img alt="\\begin{align*} x &amp;= \\frac{1}{2} \\binom{2k}{k} \\pmod p \\\\ y &amp;= (2k)\\!!\\, x \\pmod p \\end{align*}" class="aligncenter" height="76" src="https://www.johndcook.com/pythagprime2.svg" style="background-color: white;" width="176" /></p>\n<p>For <em>x</em> and <em>y</em> we choose the residues mod <em>p</em> with |<em>x</em>| and |<em>y</em>| less than\xa0<em>p</em>/2.</p>\n<p>Why would Wagon say Gauss&#8217; formula is computationally useless? The number of multiplications required is apparently on the order of\xa0<em>p</em> and the size of the numbers involved grows like\xa0<em>p</em>!.</p>\n<p>You can get around the problem of intermediate numbers getting too large by carrying out all calculations mod\xa0<em>p</em>, but I don&#8217;t see a way of implementing Gauss&#8217; formula with less than\xa0<em>O</em>(<em>p</em>) modular multiplications [3].</p>\n<h2>Wagon&#8217;s algorithm</h2>\n<p>If we want to express a large prime\xa0<em>p</em> as a sum of two squares, an algorithm requiring <em>O</em>(<em>p</em>) multiplications is impractical. Wagon&#8217;s algorithm is much more efficient.</p>\n<p>You can find the details of Wagon&#8217;s algorithm in [3], but the two key components are finding a quadratic non-residue mod <em>p</em> (a number\xa0<em>c</em> such that\xa0<em>c</em> ≠ <em>x</em>² mod <em>p</em> for any <em>x</em>) and the Euclidean algorithm. Since half the numbers between 1 and\xa0<em>p</em> − 1 are quadratic non-residues, you&#8217;re very likely to find a non-residue after a few attempts.</p>\n<p>&nbsp;</p>\n<p>[1] The square of an integer is either equal to 0 or 1 mod 4, so the sum of two squares cannot equal 3 mod 4.</p>\n<p>[2] Stan Wagon. The Euclidean Algorithm Strikes Again. The American Mathematical Monthly, Vol. 97, No. 2 (Feb., 1990), pp. 125-129.</p>\n<p>[3] Wilson&#8217;s theorem gives a fast way to compute (<em>n</em> − 1)! mod\xa0<em>n</em>. Maybe there&#8217;s some analogous identity that could speed up the calculation of the necessary factorials mod <em>p</em>, but I don&#8217;t know what it would be.</p>\n<p>&nbsp;</p>The post <a href="https://www.johndcook.com/blog/2026/02/12/pythagorean-primes/">Expressing a prime as the sum of two squares</a> first appeared on <a href="https://www.johndcook.com/blog">John D. Cook</a>.'}

---

*抓取时间: 2026-02-13 12:02:14*
