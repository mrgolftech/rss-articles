# Race between primes of the forms 4k + 1 and 4k + 3

**来源:** [johndcook.com](https://johndcook.com)
**发布时间:** Sun, 15 Feb 2026 19:19:08 +0000
**链接:** https://www.johndcook.com/blog/2026/02/15/chebyshev-bias/

---

{'type': 'text/html', 'language': None, 'base': 'https://www.johndcook.com/blog/feed/', 'value': '<p>The last few posts have looked at expressing an odd prime <em>p</em> as a sum of two squares. This is possible if and only if\xa0<em>p</em> is of the form 4<em>k</em> + 1. I illustrated an algorithm for finding the squares with\xa0<em>p</em> = 2<sup>255</sup> − 19, a prime that is used in cryptography. It is being used in bringing this page to you if the TLS connection between my server and your browser is uses Curve25519 or Ed25519.</p>\n<h2>World records</h2>\n<p>I thought about illustrating the algorithm with a larger prime too, such as a world record. But then I realized all the latest record primes have been of the form 4<em>k</em> + 3 and so cannot be written as a sum of squares. Why is <em>p</em> mod 4 equal to 3 for all the records? Are more primes congruent to 3 than to 1 mod 4? The answer to that question is subtle; more on that shortly.</p>\n<p>More record primes are congruent to 3 mod 4 because Mersenne primes are easier to find, and that&#8217;s because there&#8217;s an algorithm, the Lucas-Lehmer test, that can test whether a Mersenne number is prime more efficiently than testing general numbers. Lucas developed his test in 1878 and Lehmer refined it in 1930.</p>\n<p>Since the time Lucas first developed his test, the largest known prime has always been a Mersenne prime, with exceptions in 1951 and in 1989.</p>\n<h2>Chebyshev bias</h2>\n<p>So, are more primes congruent to 3 mod 4 than are congruent to 1 mod 4?</p>\n<p>Define the function\xa0<em>f</em>(<em>n</em>) to be the ratio of the number of primes in each residue class.</p>\n<p style="padding-left: 40px;"><em>f</em>(<em>n</em>) = (# primes <em>p</em> &lt; <em>n</em> with\xa0<em>p</em> = 3 mod 4) / (# primes <em>p</em> &lt; <em>n</em> with\xa0<em>p</em> = 1 mod 4)</p>\n<p>As\xa0<em>n</em> goes to infinity, the function\xa0<em>f</em>(<em>n</em>) converges to 1. So in that sense the number of primes in each category are equal.</p>\n<p>If we look at the difference rather than the ratio we get a more subtle story. Define the lead function to be how much the count of primes equal to 3 mod 4 leads the number of primes equal to 1 mod 4.</p>\n<p style="padding-left: 40px;"><em>g</em>(<em>n</em>) = (# primes <em>p</em> &lt; <em>n</em> with\xa0<em>p</em> = 3 mod 4) − (# primes <em>p</em> &lt; <em>n</em> with\xa0<em>p</em> = 1 mod 4)</p>\n<p>For any\xa0<em>n</em>,\xa0<em>f</em>(<em>n</em>) &gt; 1 if and only if\xa0<em>g</em>(<em>n</em>) &gt; 0. However, as\xa0<em>n</em> goes to infinity the function\xa0<em>g</em>(<em>n</em>) does not converge. It oscillates between positive and negative infinitely often. But\xa0<em>g</em>(<em>n</em>) is positive for long stretches. This phenomena is known as Chebyshev bias.</p>\n<h2>Visualizing the lead function</h2>\n<p>We can calculate the lead function at primes with the following code.</p>\n<pre>from numpy import zeros\nfrom sympy import primepi, primerange\n\nN = 1_000_000\nleads = zeros(primepi(N) + 1)\nfor index, prime in enumerate(primerange(2, N), start=1):\n    leads[index] = leads[index - 1] + prime % 4 - 2\n</pre>\n<p>Here is a list of the primes at which the lead function is zero, i.e. when it changes sign.</p>\n<pre>[   0,     1,     3,     7,    13,    89,  2943,  2945,  2947,\n 2949,  2951,  2953, 50371, 50375, 50377, 50379, 50381, 50393,\n50413, 50423, 50425, 50427, 50429, 50431, 50433, 50435, 50437,\n50439, 50445, 50449, 50451, 50503, 50507, 50515, 50517, 50821,\n50843, 50853, 50855, 50857, 50859, 50861, 50865, 50893, 50899,\n50901, 50903, 50905, 50907, 50909, 50911, 50913, 50915, 50917,\n50919, 50921, 50927, 50929, 51119, 51121, 51123, 51127, 51151,\n51155, 51157, 51159, 51161, 51163, 51177, 51185, 51187, 51189,\n51195, 51227, 51261, 51263, 51285, 51287, 51289, 51291, 51293,\n51297, 51299, 51319, 51321, 51389, 51391, 51395, 51397, 51505,\n51535, 51537, 51543, 51547, 51551, 51553, 51557, 51559, 51567,\n51573, 51575, 51577, 51595, 51599, 51607, 51609, 51611, 51615,\n51617, 51619, 51621, 51623, 51627]\n</pre>\n<p>This is OEIS sequence <a href="https://oeis.org/A038691">A038691</a>.</p>\n<p>Because the lead function changes more often in some regions than others, it&#8217;s best to plot the function over multiple ranges.</p>\n<p><img class="aligncenter size-medium" height="360" src="https://www.johndcook.com/chebbias1.png" width="480" /></p>\n<p><img class="aligncenter size-medium" height="360" src="https://www.johndcook.com/chebbias2.png" width="480" /></p>\n<p><img class="aligncenter size-medium" height="360" src="https://www.johndcook.com/chebbias3.png" width="480" /></p>\n<p><img class="aligncenter size-medium" height="360" src="https://www.johndcook.com/chebbias4.png" width="480" /></p>\n<p><img class="aligncenter size-medium" height="360" src="https://www.johndcook.com/chebbias5.png" width="480" /></p>\n<p>The lead function is more often positive than negative. And yet it is zero infinitely often. So while the count of primes with remainder 3 mod 4 is usually ahead, the counts equal out infinitely often.</p>The post <a href="https://www.johndcook.com/blog/2026/02/15/chebyshev-bias/">Race between primes of the forms 4k + 1 and 4k + 3</a> first appeared on <a href="https://www.johndcook.com/blog">John D. Cook</a>.'}

---

*抓取时间: 2026-02-18 18:04:21*
