# Wrapping Code Comments

**来源:** [matklad.github.io](https://matklad.github.io)
**发布时间:** 2026-02-21T00:00:00+00:00
**链接:** https://matklad.github.io/2026/02/21/wrapping-code-comments.html

---

{'type': 'text/html', 'language': None, 'base': 'https://matklad.github.io/2026/02/21/wrapping-code-comments.html', 'value': '<header>\n  <h1>Wrapping Code Comments</h1>\n  <time class="meta" datetime="2026-02-21">Feb 21, 2026</time>\n</header>\n<p>I was today years old when I realized that:</p>\n<ul>\n<li>\nCode and code comments ideally should be wrapped to a different column.\n</li>\n<li>\nFor comments, the width should be relative to the start of the comment.\n</li>\n</ul>\n<p>It’s a good idea to limit line length to about 100 columns. This is a physical limit, the width at\nwhich you can still comfortably fit two editors side by side (see\n<a href="https://matklad.github.io/2025/11/28/size-matters.html"><em>Size Matters</em></a>). Note an apparent\ncontradiction: the optimal width for readable prose is usually taken to be narrower, 60–70 columns.\nThe contradiction is resolved by noticing that, for code, indentation eats into usable space.\nTypically, code is much less typographically dense than prose.</p>\n<p>Still, I find comment blocks easier to read when they are  wrapped narrower than the surrounding\ncode. I want lines to be wrapped at 100, and <em>content</em> of comments to be wrapped at 70 (unless that\npushes overall line to be longer than 100). That is, I want layout like this (using 20/30 rulers\ninstead of 70/100, for illustrative purposes):</p>\n\n<figure class="code-block">\n\n\n<pre><code><span class="line"><span class="hl-comment">// Top level comments</span></span>\n<span class="line"><span class="hl-comment">// can be this wide.</span></span>\n<span class="line"><span class="hl-keyword">const</span> S = <span class="hl-keyword">struct</span> {</span>\n<span class="line">    <span class="hl-comment">// Nested comments are</span></span>\n<span class="line">    <span class="hl-comment">// also this wide, but</span></span>\n<span class="line">    <span class="hl-comment">// are shifted right.</span></span>\n<span class="line">    <span class="hl-keyword">fn</span><span class="hl-function"> f</span>() <span class="hl-type">void</span> {</span>\n<span class="line">        <span class="hl-keyword">switch</span> (value) {</span>\n<span class="line">            <span class="hl-numbers">0</span> =&gt; {</span>\n<span class="line">                <span class="hl-comment">// But there is</span></span>\n<span class="line">                <span class="hl-comment">// a hard limit.</span></span>\n<span class="line">            }</span>\n<span class="line">        }</span>\n<span class="line">    }</span>\n<span class="line">}</span></code></pre>\n\n</figure>\n<p>This feels obvious in retrospect, but notably isn’t be well-supported by the tools? The\n<a href="https://marketplace.visualstudio.com/items?itemName=stkb.rewrap">VS Code extension</a> I use allows\nconfiguring dedicated fill column for comments, but doesn’t make it <em>relative</em>, so indented comment\nblocks are always narrower than top-level ones. Emacs <code>M-q</code> also doesn’t do relative wrapping out of\nthe box!</p>\n<hr />\n<p>Aside on hard-wrapping: should we bother with wrapping comments at all? Can’t we rely on our editor\nto implement soft-wrapping? The problem with soft-wrapping is that you can’t soft-wrap text\ncorrectly without understanding its meaning. Consider a markdown list:</p>\n\n<figure class="code-block">\n\n\n<pre><code><span class="line">A list:</span>\n<span class="line">  * item one,</span>\n<span class="line">  * item two.</span></code></pre>\n\n</figure>\n<p>If the first item is long enough to necessitate wrapping, the wrapped line should also be indented,\nwhich requires parsing the text as markdown first:</p>\n\n<figure class="code-block">\n\n\n<pre><code><span class="line">A list:</span>\n<span class="line">  * item one which is long enough</span>\n<span class="line">    necessitate wrapping,</span>\n<span class="line">  * item two.</span></code></pre>\n\n</figure>'}

---

*抓取时间: 2026-02-22 00:02:38*
